<!DOCTYPE html>
<html>
<head>
   <title>EZCheckin</title>
   <link href="http://apps.bdimg.com/libs/bootstrap/3.3.0/css/bootstrap.min.css" rel="stylesheet">
   <script src="http://apps.bdimg.com/libs/jquery/2.0.0/jquery.min.js"></script>
   <script src="http://apps.bdimg.com/libs/bootstrap/3.3.0/js/bootstrap.min.js"></script>

   <meta name="viewport" content="width=device-width, 
                                     initial-scale=1.0, 
                                     maximum-scale=1.0, 
                                     user-scalable=no">
</head>
<body>

<div id="nowtime">  
</div>  
<div id="divNowTime">  
</div>  


<div id="divResult">  
<p>课程号：{{ course.course_number }}   
</p>
{% if studentList %}
	<div class="table-responsive">
		<table class="table">
		   <caption>签到名单</caption>
		   <thead>
		      <tr>
			 <th>学号</th>
			 <th>姓名</th>
			 <th>时间request</th>
			 <th>时间qrcode</th>
			 <th>heartbeats</th>
		      </tr>
		   </thead>
		   <tbody>

			{% for student in course.student_set.all %}
		      	<tr>
				 <td>{{ student.student_number }}</td>
				 <td>{{ student.student_name }}</td>
				 <td>{{ student.student_requestTime|date:"m-d H:i:s" }}</td>
				 <td>{{ student.student_qrcodeTime|date:"m-d H:i:s" }}</td>
				 <td>{{ student.student_heartbeatCount }}</td>
		      	</tr>
			{% endfor %}
		   </tbody>
		</table>
	</div>  	
{% else %}
    <p>No students are available.</p>
{% endif %}


</div> 

<script type="text/javascript" language="javascript"> 
		var hidden, state, visibilityChange; 
		if (typeof document.hidden !== "undefined") {
			hidden = "hidden";
			visibilityChange = "visibilitychange";
			state = "visibilityState";
		} else if (typeof document.mozHidden !== "undefined") {
			hidden = "mozHidden";
			visibilityChange = "mozvisibilitychange";
			state = "mozVisibilityState";
		} else if (typeof document.msHidden !== "undefined") {
			hidden = "msHidden";
			visibilityChange = "msvisibilitychange";
			state = "msVisibilityState";
		} else if (typeof document.webkitHidden !== "undefined") {
			hidden = "webkitHidden";
			visibilityChange = "webkitvisibilitychange";
			state = "webkitVisibilityState";
		}
		
		// Add a listener that constantly changes the title
		document.addEventListener(visibilityChange, function() {
			document.title = document[state];
		}, false);
 
    $(document).ready(function () {  
        setInterval("startRequest()", 3000);  
    });  

    function startRequest() {  
        $("#nowtime").text((new Date()).toString());  
        $('#divNowTime').text((new Date()).toLocaleDateString() + " " + (new Date()).toLocaleTimeString());  
  
        $.ajax({  
            url: "newtable/",  
            type: 'POST',  
            data: {  
                name: 1,  
                kkk: "ok"  
            },  
            success: function (responseText) {  
               
                $("#divResult").html(responseText);  
            }  
        });  
    }  
</script>  

</body>
</html>
